<div class="tagline">
  <h3>Find where your favorite production has filmed!</h3>
</div>



<div class="row">

  <div class="large-4 columns">
    <div class="search_form">
      <%= render 'maps/form' %>
    </div>
    <div id="search_results">
      <div class="transparent"></div>
      <div class="opaque">
        <div class="results_list">
          <p class="notice"><%= notice %></p>
          <p class="alert"><%= alert %></p>
          <!-- <p id="search_term">Results for: <span>"<%= @map.location %>"</span></p> -->

          <p id="search_term">Recent entries:</p>
          <ul>
            <% @locations.each do |location| %>
              <li><a href="javascript:void(0);" onclick="showAddress('<%= location.address.chomp.gsub('%2','+') %>')"><%= location.title %></a></li>
            <% end %>
          </ul>
        </div>
      </div>
    </div>
  </div>

  <div id="newmap" class="large-8 columns">
    <div id="loader"></div>
  </div>


</div>


<script type="text/javascript">

  $(document).ready(function() {

    function buildMap(lat, lon) {
      $('#newmap').append('<iframe id="mapcanvas" width="800" height="650" frameborder="0" style="border:0" src="https://www.google.com/maps/embed/v1/place?key=AIzaSyAOrWdN-Ob7lti6iBQrbf9ThMqZO2X8dn0&q=' + lat + ', ' + lon + '"></iframe>');
      $('#loader').delay(200).fadeToggle('slow');


    };

    function showPosition(position) {
      lat = position.coords.latitude
      lon = position.coords.longitude

      buildMap(lat, lon)
    };

    navigator.geolocation.getCurrentPosition(showPosition);

  });

</script>
